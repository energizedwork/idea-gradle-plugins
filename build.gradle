buildscript {
    repositories {
        maven {
            url 'https://plugins.gradle.org/m2/'
        }
    }
    dependencies {
        classpath 'com.gradle.publish:plugin-publish-plugin:0.9.6'
    }
}

apply plugin: 'idea'
apply plugin: 'groovy'
apply plugin: 'java-gradle-plugin'
apply plugin: 'com.energizedwork.idea-junit'
apply plugin: 'codenarc'
apply plugin: 'com.gradle.plugin-publish'

apply from: 'gradle/dependencyRules.gradle'
apply from: 'gradle/idea/idea.gradle'

version = '1.0'

repositories {
    mavenCentral()
}

dependencies {
    codenarc('org.codenarc:CodeNarc:0.26.0') {
        exclude module: 'GMetrics'
    }

    testCompile 'org.spockframework:spock-core:1.1-groovy-2.4-rc-3'
}

codenarc.configFile = rootProject.file('gradle/codenarc/rulesets.groovy')

gradlePlugin {
    plugins {
        ideaJunitPlugin {
            id = 'com.energizedwork.idea-junit'
            implementationClass = 'com.energizedwork.gradle.idea.IdeaJunitPlugin'
        }
    }
}

pluginBundle {
    vcsUrl = 'https://github.com/energizedwork/idea-gradle-plugins'

    plugins {
        ideaJunitPlugin {
            website = 'https://github.com/energizedwork/idea-gradle-plugins#idea-junit-plugin'
            description = 'A plugin that allows to control settings of default JUnit run configuration in IntelliJ.'
            id = 'com.energizedwork.idea-junit'
            displayName = 'Idea JUnit plugin'
            tags = ['idea', 'IntelliJ', 'JUnit']
        }
    }
}